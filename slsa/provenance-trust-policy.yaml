version: '2.0'
signature:
  verify: true
  certificate: |
    -----BEGIN CERTIFICATE-----
    MIICJzCCAc2gAwIBAgIUYW90KUo9q/fjeLGX1cm9gjEiWnowCgYIKoZIzj0EAwIw
    gYgxDTALBgNVBAMMBEdoYWYxCzAJBgNVBAYTAkZJMRAwDgYDVQQHDAdUYW1wZXJl
    MRAwDgYDVQQIDAdUYW1wZXJlMQ0wCwYDVQQKDARHaGFmMTcwNQYJKoZIhvcNAQkB
    FihhbGVrc2FuZHIudHNlcmVwb3Ytc2F2b2xhaW5lbkB1bmlraWUuY29tMB4XDTI1
    MTIwMjA5MzcwNloXDTI2MTIwMjA5MzcwNlowgYgxDTALBgNVBAMMBEdoYWYxCzAJ
    BgNVBAYTAkZJMRAwDgYDVQQHDAdUYW1wZXJlMRAwDgYDVQQIDAdUYW1wZXJlMQ0w
    CwYDVQQKDARHaGFmMTcwNQYJKoZIhvcNAQkBFihhbGVrc2FuZHIudHNlcmVwb3Yt
    c2F2b2xhaW5lbkB1bmlraWUuY29tMCowBQYDK2VwAyEAFgPVn2T8wSXjrGha1fD/
    mkzyUKutFXVIapgpsnxjaVejQjBAMB0GA1UdDgQWBBQXnznoyC4WTyhFqEFpPAeS
    Y8fXFjAfBgNVHSMEGDAWgBR/EOFtpprcETaRKKW+MQTf06BkyjAKBggqhkjOPQQD
    AgNIADBFAiB/+xDUOL2/Njb3XHR8t1ToOWyetz2NLHUn6BeaNFvamAIhAOhB1J/7
    kRb9C0uMmmwPZN8UcZcTFh8G1WAHwR3DJ0AJ
    -----END CERTIFICATE-----

criteria:
  - id: target-repo-ghaf
    description: Target repository is tiiuae/ghaf
    required: true
    cel: predicate.buildDefinition.externalParameters.target.repository == 'https://github.com/tiiuae/ghaf/'

  - id: built-recently
    description: Build was finished less than 3 hours ago
    required: true
    cel: now - timestamp(predicate.runDetails.metadata.finishedOn) < duration('3h')

  - id: builder-id-hetzner
    description: Built on Hetzner CI dev, prod or release
    required: true
    cel: |
      predicate.runDetails.builder.id in [
        'https://ci-dev.vedenemo.dev/',
        'https://ci-prod.vedenemo.dev/',
        'https://ci-release.vedenemo.dev/'
      ]
